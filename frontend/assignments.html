<!doctype html>
<html>

	<head>
		<title>
			assignments - portal++
		</title>
		<link rel="apple-touch-icon" href="apple-touch-icon.png" rel="preload">
		<link rel="manifest" href="manifest.webmanifest">
		<link rel="shortcut icon" href="favicon.ico">
		<link rel="stylesheet" href="style.css">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="viewport" content="width=device-width, initial-scale=1, height=device-height" />
		<script src="common.js"></script>

		<!-- dragula -->
		<script src="https://cdn.jsdelivr.net/gh/bevacqua/dragula@3.7.3/dist/dragula.min.js"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bevacqua/dragula@3.7.3/dist/dragula.min.css">

		<script src="https://cdn.jsdelivr.net/npm/localforage@1.9.0/dist/localforage.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/dayjs"></script>
		<script src="https://cdn.jsdelivr.net/npm/dayjs/plugin/relativeTime.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/handlebars@4.7.7/dist/handlebars.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/autolink-js@1.0.2/autolink-min.js"></script>
		<script src="page_scripts/assignments.js"></script>
	</head>

	<body onload="init()">
		<div id="header" onwheel="scroll_horizontally(event)" class="tab-cont">
			<!-- this will be filled with the template from templates/header.hbs -->
		</div>
		<script id="assignment_template" type="text/x-handlebars-template">
			{{#each assignments}}
				<div class="assignment rounded-cont flex flex-v-center text-left" id="assignment-{{this.id}}" data-assign-id="{{this.id}}" data-index-id="{{this.index_id}}" data-user-task="{{this.user_task}}" onclick="toggle_expand('{{this.id}}')" data-expanded="false">
					<div>
						<h4 id="assign-title-{{this.id}}">
							{{this.title}}
						</h4>
						<h4 id="long-title-{{this.id}}" class="hidden">
							{{this.long_title}}
						</h4>
						<small id="short-class-{{this.id}}">
							{{this.short_class}}
						</small>
						<small id="long-class-{{this.id}}" class="hidden">
							{{this.long_class}}
						</small>
						<p class="standard_transition hidden" id="desc-{{this.id}}" ondrag="event.stopPropagation();">
							{{this.desc}}
						</p>
						<h5 class="assigned">
							Assigned {{assign_date}}
						</h5>
						<h5>
							Due {{due_date}}
						</h5>
						<div class="hidden" style="padding-top: 5px;" id="edit-div-{{this.id}}">
							{{#if this.user_task}}
								<span class="link" onclick="event.stopPropagation();show_add_popup({{this.id}})" id="edit-button-{{this.id}}"> edit</span>
							{{/if}}
							{{#if this.is_submission}}
								<br>
								submission assignments are not currently supported. to submit this assignment, use the official client
							{{/if}}
						</div>
					</div>

					<div>
						<span class="round-indicator indicator-{{this.indicator.class}}" id="assignment-ind-{{this.id}}" onclick="queue_update('{{this.index_id}}', {{this.id}}, {{this.user_task}}, event)">
							{{this.indicator.text}}
						</span>
					</div>
				</div>
			{{/each}}
		</script>

		<script id="assignment_expanded_template" type="text/x-handlebars-template">
			<!-- this template is placed into the <p id="desc-ASSIGN_ID"> of an assignment when it is expanded -->
			{{description}}

			{{#if links}}
				<div class="rounded-cont medium-background link-cont">
					<h3 class="title">
						Links
					</h3>
					{{#each links}}
						<a href="{{this.url}}" target="_blank" onclick="event.stopPropagation();">
							{{this.title}}
						</a>
					{{/each}}
				</div>
			{{/if}}
			{{#if downloads}}
				<div class="rounded-cont medium-background link-cont">
					<h3 class="title">
						Downloads
					</h3>
					{{#each downloads}}
						<a href="{{this.url}}" onclick="event.stopPropagation();" download="{{this.filename}}">
							{{this.title}}
						</a>
					{{/each}}
				</div>
			{{/if}}

		</script>

		<script id="usertaskadd_template" type="text/x-handlebars-template">
			<span class="round-button close-button" onclick="hide_add_popup()">
				<!-- this is the unicode vector or cross produxt X, U+2A2F -->
				&#10799;
			</span>
			<span class="form-title">
				{{#if editing}}
					Edit
				{{else}}
					Add
				{{/if}}
				Task
			</span>
			<hr class="title_sep">
			
			<input id="add_task_name" placeholder="do stuff" autocomplete="off" type="text" maxlength="500" 
			{{#if editing}}
				value="{{assign_name}}"
			{{/if}}
			>
			<div>
				<span class="input-label">
					class
				</span>
				<div class="select-cont">
					<select id="add_classname">
						<option value="null">
							General Task
						</option>
						{{#each classes}}
							<option value="{{this.id}}" id="edit-option-{{this.id}}">
								{{this.name}}
							</option>
						{{/each}}
					</select>
				</div>
			</div>
			
			<div>
				<span class="input-label">
					assign date
				</span>
				<input type="date" id="add_assign_date" class="inline-input" value="{{assign_date}}">
			</div>
			
			<div>
				<span class="input-label">
					due date
				</span>
				<input type="date" id="add_due_date" class="inline-input" value="{{due_date}}">
			</div>
			
			<div class="button" 
				{{#if editing}}
					onclick="save_assignment({{user_id}}, {{assign_id}})"
				{{else}}
					onclick="save_assignment({{user_id}})" 
				{{/if}}
			id="save_assign">
				save
			</div>
			{{#if editing}}
				<div class="button bad_button" onclick="delete_assignment({{assign_id}})">
					delete
				</div>
			{{/if}}
		</script>

		<div id="add_task" class="rounded-cont fixed-center form hidden standard_transition popup">
			<!-- this will be filled in with the template in #usertaskadd_template -->
		</div>

		<div class="full-container">
			<div class="center">
				<h2>
					<span class="round-button" onclick="change_date(-1)">
						&lt
					</span>
					<span id="date">
						<!-- nothing -->
					</span>
					<span class="round-button" onclick="change_date(1)">
						&gt
					</span>
				</h2>
			</div>

			<span class="round-button topright-button" onclick="show_add_popup()" id="add_button" title="add task">
				+
			</span>

			<div class="flex flex-center flex-equal-width center flex-wrap">
				<div>
					<h3> todo </h3>
					<div id="todo" class="scrollable-col">

					</div>
				</div>

				<div>
					<h3> in progress </h3>
					<div id="progress" class="scrollable-col">

					</div>
				</div>

				<div>
					<h3> done </h3>
					<div id="done" class="scrollable-col">

					</div>
				</div>
			</div>
		</div>
	</body>

</html>
